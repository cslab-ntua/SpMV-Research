#!/bin/bash

filepath=$1

  if [ ! -d "../dataset" ]; then  
    mkdir "../dataset"  
  fi  

if [ ! -f $filepath ]; then
   wget https://sparse.tamu.edu/MM/SNAP/web-Google.tar.gz
   tar xvf web-Google.tar.gz
   mv web-Google/web-Google.mtx ../dataset/
   rm -rf web-Google*
   filepath=../dataset/web-Google.mtx
fi

echo " ******************************************************************************************************************** "
echo " ******************************************************************************************************************** "
echo " ****************************           Running    CVR            *************************************************** "  
numactl --membind=1 ./bin/spmv.cvr $filepath 68 1000

echo " ******************************************************************************************************************** "
echo " ******************************************************************************************************************** "
echo " ****************************           Running    CSR5            *************************************************** "  
numactl --membind=1 ./bin/spmv.csr5 $filepath 204 1000

echo " ******************************************************************************************************************** "
echo " ******************************************************************************************************************** "
echo " ****************************           Running    VHCC            *************************************************** "  
numactl --membind=1 ./bin/spmv.vhcc $filepath 272 1000 1

echo " ******************************************************************************************************************** "
echo " ******************************************************************************************************************** "
echo " ****************************           Running    CSR-I           *************************************************** "  
numactl --membind=1 ./bin/spmv.csr $filepath 272 1000

echo " ******************************************************************************************************************** "
echo " ******************************************************************************************************************** "
echo " ****************************           Running    ESB            *************************************************** "  
numactl --membind=1 ./bin/spmv.esb $filepath 272 1000 3

echo " ******************************************************************************************************************** "
echo " ******************************************************************************************************************** "
echo " ****************************           Running    MKL            *************************************************** "  
numactl --membind=1 ./bin/spmv.mkl $filepath 272 1000
